<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="马浩珍在 Github 上的个人博客">
    <meta name="keyword" content="">
    <meta name="theme-color" content="#600090">
    <meta name="msapplication-navbutton-color" content="#600090">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="#600090">
    <link rel="shortcut icon" href="https://cdn4.iconfinder.com/data/icons/ionicons/512/icon-person-128.png">
    <link rel="alternate" type="application/atom+xml" title="Haojen" href="/atom.xml">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">
    <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.css">
    <title>
        
        Mybaits｜Haojen&#39;s blog
        
    </title>

    <link rel="canonical" href="http://haojen.github.io/2024/03/22/Mybatis/">

    <!-- Bootstrap Core CSS -->
    
<link rel="stylesheet" href="/css/bootstrap.min.css">


    <!-- Custom CSS -->
    
<link rel="stylesheet" href="/css/blog-style.css">


    <!-- Pygments Github CSS -->
    
<link rel="stylesheet" href="/css/syntax.css">

<meta name="generator" content="Hexo 7.1.1"></head>

<style>

    header.intro-header {
        background-image: url('//o7bkkhiex.bkt.clouddn.com/lion-blur-bg.jpg')
    }
</style>
<!-- hack iOS CSS :active style -->
<body ontouchstart="" class="animated fadeIn">
<!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top " id="nav-top" data-ispost = "true" data-istags="false
" data-ishome = "false" >
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand animated pulse" href="/">
                <span class="brand-logo">
                    Haojen
                </span>
                's Blog
            </a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
        <!-- /.navbar-collapse -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>
					
                    
					
					
                </ul>
            </div>
        </div>
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
//    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        // CLOSE
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        // OPEN
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>

<!-- Main Content -->

<!--only post-->


<img class="wechat-title-img"
     src="">


<style>
    
    header.intro-header {
        background-image: url('')
    }

    
</style>

<header class="intro-header">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 text-center">
                <div class="post-heading">
                    <h1>Mybaits</h1>
                    
                    <span class="meta">
                         作者 maomaomomo
                        <span>
                          日期 2024-03-22
                         </span>
                    </span>
                    <div class="tags text-center">
                        
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="post-title-haojen">
        <span>
            Mybaits
        </span>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <!-- Post Container -->
            <div class="col-lg-8 col-lg-offset-1 col-sm-9 post-container">
                <h1 id="Mybaits面试题"><a href="#Mybaits面试题" class="headerlink" title="Mybaits面试题"></a>Mybaits面试题</h1><h2 id="001简单介绍下Mybatis？"><a href="#001简单介绍下Mybatis？" class="headerlink" title="001简单介绍下Mybatis？"></a>001简单介绍下Mybatis？</h2><p>1.Mybatis是一个半ORM（对象关系映射）框架，它内部封装了JDBC，开发时只需要关注SQL语句本身，不需要花费精力去处理加载驱动、创建连接、创建statement等繁杂的过程；<br>2.MyBatis 可以使用 XML 或注解来配置和映射原生信息，将 POJO映射成数据库中的记录，避免了几乎所有的 JDBC 代码和手动设置参数以及获取结果集；<br>3.通过xml 文件或注解的方式将要执行的各种 statement 配置起来，并通过java对象和 statement中MySQL的动态参数进行映射生成最终执行的sql语句，最后由mybatis框架执行sql并将结果映射为java对象并返回。</p>
<h2 id="002Mybatis编程步骤-？"><a href="#002Mybatis编程步骤-？" class="headerlink" title="002Mybatis编程步骤 ？"></a>002Mybatis编程步骤 ？</h2><p>1.创建SqlSessionFactory<br>2.通过SqlSessionFactory创建SqlSession<br>3.通过SqlSession执行数据库操作<br>4.调用SqlSession的commit()方法提交事务<br>5.调用SqlSession的close()方法关闭会话</p>
<h2 id="003MyBatis的优点？"><a href="#003MyBatis的优点？" class="headerlink" title="003MyBatis的优点？"></a>003MyBatis的优点？</h2><p>1.基于SQL语句编程，相对灵活，接触sql与程序代码的藕合，便于统一管理，支持写动态sql语句并可重复使用；<br>2.减少代码量，消除了冗余代码；<br>3.数据库兼容能够与Spring集成；<br>4.提供映射标签支持字段关系映射；</p>
<h2 id="004MyBatis的缺点？"><a href="#004MyBatis的缺点？" class="headerlink" title="004MyBatis的缺点？"></a>004MyBatis的缺点？</h2><p>1.SQL语句的编写工作量较大，尤其当字段多、关联表多时，对开发人员编写SQL的功底有一定要求；<br>2.SQL语句依赖于数据库，导致数据库移植性差，不能随意更换数据库。</p>
<h2 id="005MyBatis中-和-的区别？"><a href="#005MyBatis中-和-的区别？" class="headerlink" title="005MyBatis中$和#的区别？"></a>005MyBatis中$和#的区别？</h2><p>1.传入的参数在SQL中显示不同<br>#传入的参数在SQL中相当占位符，#方式能够很大程度防止sql注入；而$传入的参数在SQL中相当字符串，$方式无法防止Sql注入.<br>-——————————————-<br>例：使用以下SQL<br>1)select id,name,age from student where name&#x3D;#{name};<br>2)select id,name,age from student where name &#x3D;${name}:<br>当我们传递的参数name为 “‘zs   ‘ or 1&#x3D;1” 时，上述 sql分别会解析为：<br>select id,name,age from student where id &#x3D;”‘zs’ or 1&#x3D;1”<br>select id,name,age from student where id &#x3D;‘zs’ or 1&#x3D;1<br>这样第二条sql语句的会查出所有学生的信息，这是非常不安全的，有sql注入的风险。所以#可以防止SQL注入的风险（语句的拼接）；但$无法防止Sql注入。<br>-—————————————————–<br>2.$方式一般用于传入数据库对象，例如传入表名。<br>3.大多数情况下还是经常使用#，但有些情况下必须使用$，例：MyBatis排序时使用order by 动态参数时需要注意，用$而不是#。</p>
<h2 id="006Mybatis的一级、二级缓存？"><a href="#006Mybatis的一级、二级缓存？" class="headerlink" title="006Mybatis的一级、二级缓存？"></a>006Mybatis的一级、二级缓存？</h2><p>1.一级缓存 Mybatis的一级缓存是指SQLSession，一级缓存的作用域是SQlSession, Mabits默认开启一级缓存。 在同一个SqlSession中，执行相同的SQL查询时；第一次会去查询数据库，并写在缓存中，第二次会直接从缓存中取。 当执行SQL时候两次查询中间发生了增删改的操作，则SQLSession的缓存会被清空。 每次查询会先去缓存中找，如果找不到，再去数据库查询，然后把结果写到缓存中。 Mybatis的内部缓存使用一个HashMap，key为hashcode+statementId+sql语句。Value为查询出来的结果集映射成的java对象。 SqlSession执行insert、update、delete等操作commit后会清空该SQLSession缓存。<br>2.二级缓存 二级缓存是mapper级别的，Mybatis默认是没有开启二级缓存的。 第一次调用mapper下的SQL去查询用户的信息，查询到的信息会存放代该mapper对应的二级缓存区域。 第二次调用namespace下的mapper映射文件中，相同的sql去查询用户信息，会去对应的二级缓存内取结果。 如果调用相同namespace下的mapepr映射文件中增删改sql，并执行了commit操作，此时会情况该</p>
<h2 id="007Mybatis-是如何进行分页的？分页插件的原理是什么？"><a href="#007Mybatis-是如何进行分页的？分页插件的原理是什么？" class="headerlink" title="007Mybatis 是如何进行分页的？分页插件的原理是什么？"></a>007Mybatis 是如何进行分页的？分页插件的原理是什么？</h2><p>Mybatis 使用 RowBounds 对象进行分页，它是针对 ResultSet 结果集执行的内 存分页，而非物理分页。可以在 sql 内直接书写带有物理分页的参数来完成物理分 页功能，也可以使用分页插件来完成物理分页。 分页插件的基本原理是使用 Mybatis 提供的插件接口，实现自定义插件，在插件 的拦截方法内拦截待执行的 sql，然后重写 sql，根据 dialect 方言，添加对应的物 理分页语句和物理分页参数。举例：select * from student，拦截sql后重写为：select t.* from （select * from student）t limit 0，10</p>
<h2 id="008Mapper动态代理的实现原理？"><a href="#008Mapper动态代理的实现原理？" class="headerlink" title="008Mapper动态代理的实现原理？"></a>008Mapper动态代理的实现原理？</h2><p>Mybatis使用JDK的动态代理，为需要拦截的接口生成代理对象以实现接口方法拦截功能，每当执行这4种接口对象的方法时，就会进入拦截方法，具体就是InvocationHandler的invoke()方法。</p>
<h2 id="009MyBatis是否支持延迟加载？如果支持，它的实现原理是什么？"><a href="#009MyBatis是否支持延迟加载？如果支持，它的实现原理是什么？" class="headerlink" title="009MyBatis是否支持延迟加载？如果支持，它的实现原理是什么？"></a>009MyBatis是否支持延迟加载？如果支持，它的实现原理是什么？</h2><p>1)在MyBatis配置文件中，可以配置是否启用延迟加载lazyLoadingEnabled&#x3D;true|false。MyBatis仅支持association关联对象和collection关联集合对象的延迟加载，association指的就是一对一，collection指的就是一对多查询。<br>2)它的原理是，使用CGLIB创建目标对象的代理对象，当调用目标方法时，进入拦截器方法，比如调用a.getB().getName()，拦截器invoke()方法发现a.getB()是null值，那么就会单独发送事先保存好的查询关联B对象的sql，把B查询上来，然后调用a.setB(b)，于是a的对象b属性就有值了，接着完成a.getB().getName()方法的调用。这就是延迟加载的基本原理。</p>
<h2 id="010MyBatis与Hibernate有哪些不同？"><a href="#010MyBatis与Hibernate有哪些不同？" class="headerlink" title="010MyBatis与Hibernate有哪些不同？"></a>010MyBatis与Hibernate有哪些不同？</h2><p>1.Mybatis和hibernate不同，它不完全是一个ORM框架，因为MyBatis需要程序员自己编写Sql语句。<br>2.Mybatis直接编写原生态sql，可以严格控制sql执行性能，灵活度高，非常适合对关系数据模型要求不高的软件开发，因为这类软件需求变化频繁，一但需求变化要求迅速输出成果。但是灵活的前提是mybatis无法做到数据库无关性，如果需要实现支持多种数据库的软件，则需要自定义多套sql映射文件，工作量大。<br>3.Hibernate对象&#x2F;关系映射能力强，数据库无关性好，对于关系模型要求高的软件，如果用hibernate开发可以节省很多代码，提高效率。</p>
<h2 id="011IBatis-和-MyBatis-在细节上有哪些不同？"><a href="#011IBatis-和-MyBatis-在细节上有哪些不同？" class="headerlink" title="011IBatis 和 MyBatis 在细节上有哪些不同？"></a>011IBatis 和 MyBatis 在细节上有哪些不同？</h2><p>1)在 sql 里面变量命名有原来的#变量# 变成了#{变量}<br>2)原来的$变量$变成了${变量}<br>3)原来在 sql 节点里面的 class 都换名字交 type<br>4)原来的 queryForObject queryForList 变成了 selectOne selectList<br>5)原来的别名设置在映射文件里面放在了核心配置文件里<br>\1. IBatis 里面的核心处理类交 SqlMapClient,MyBatis 里面的核心处理类叫做 SqlSession</p>
<h2 id="012使用-MyBatis-的-mapper-接口调用时有哪些要求？"><a href="#012使用-MyBatis-的-mapper-接口调用时有哪些要求？" class="headerlink" title="012使用 MyBatis 的 mapper 接口调用时有哪些要求？"></a>012使用 MyBatis 的 mapper 接口调用时有哪些要求？</h2><p>1.Mapper接口方法名和mapper.xml中定义的每个sql的id相同；<br>2.Mapper接口方法的输入参数类型和mapper.xml中定义的每个sql的parameterType的类型相同；<br>3.Mapper接口方法的输出参数类型和mapper.xml中定义的每个sql的resultType的类型相同；<br>4.Mapper.xml文件中的namespace即是mapper接口的类路径;</p>
<h2 id="013当实体类中的属性名和表中的字段名不一样-，怎么办-？"><a href="#013当实体类中的属性名和表中的字段名不一样-，怎么办-？" class="headerlink" title="013当实体类中的属性名和表中的字段名不一样 ，怎么办 ？"></a>013当实体类中的属性名和表中的字段名不一样 ，怎么办 ？</h2><p>第一种：通过定义select语句中字段名的别名，让字段明的别名和实体类的属性名一致<br>第二种：通过ResutlMap来映射字段名和实体类属性名的一一对应的关系。</p>
<h2 id="014模糊查询-like-语句该怎么写"><a href="#014模糊查询-like-语句该怎么写" class="headerlink" title="014模糊查询 like 语句该怎么写?"></a>014模糊查询 like 语句该怎么写?</h2><p>第 1 种：在 Java 代码中添加 sql 通配符。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;select id=&quot;selectlike&quot;&gt;</span><br><span class="line">  select * from foo where bar like #&#123;value&#125;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure>

<p>第 2 种：在 sql 语句中拼接通配符，会引起 sql 注入</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;select id=&quot;selectlike&quot;&gt;</span><br><span class="line">  select * from foo where bar like &quot;%&quot;#&#123;value&#125;&quot;%&quot;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure>

<h2 id="015MyBatis动态sql是做什么的？都有哪些动态sql？能简述一下动态sql的执行原理不？"><a href="#015MyBatis动态sql是做什么的？都有哪些动态sql？能简述一下动态sql的执行原理不？" class="headerlink" title="015MyBatis动态sql是做什么的？都有哪些动态sql？能简述一下动态sql的执行原理不？"></a>015MyBatis动态sql是做什么的？都有哪些动态sql？能简述一下动态sql的执行原理不？</h2><p>1）MyBatis动态sql可以让我们在Xml映射文件内，以标签的形式编写动态sql，完成逻辑判断和动态拼接sql的功能，MyBatis提供了9种动态sql标签 trim | where | set | foreach | if | choose | when | otherwise | bind。<br>2）其执行原理为，使用OGNL从sql参数对象中计算表达式的值，根据表达式的值动态拼接sql，以此来完成动态sql的功能。</p>
<h2 id="016这个Dao接口的工作原理是什么？Dao接口里的方法，参数不同时，方法能重载吗"><a href="#016这个Dao接口的工作原理是什么？Dao接口里的方法，参数不同时，方法能重载吗" class="headerlink" title="016这个Dao接口的工作原理是什么？Dao接口里的方法，参数不同时，方法能重载吗?"></a>016这个Dao接口的工作原理是什么？Dao接口里的方法，参数不同时，方法能重载吗?</h2><p>Dao接口的工作原理是JDK动态代理，Mybatis运行时会使用JDK动态代理为Dao接口生成代理proxy对象，代理对象proxy会拦 截接口方法，转而执行MappedStatement所代表的sql，然后将sql执行结果返回。<br>Dao接口里的方法，是不能重载的，因为是全限名+方法名的保存和寻找策略。</p>
<h2 id="017一对一、一对多的关联查询-？"><a href="#017一对一、一对多的关联查询-？" class="headerlink" title="017一对一、一对多的关联查询 ？"></a>017一对一、一对多的关联查询 ？</h2><p>MyBatis实现一对一、一对多关联查询一般有两种方式：<br>方式一：sqlMapper配置文件<br>一对一：在resultMap标签中使用 association 标签<br>一对多：在resultMap 标签中使用collection 标签<br>方式二：注解<br>一对一：在@Results 注解中的@Result注解中使用@One注解<br>一对多：在@Results 注解中的@Result 注解中使用@Many注解</p>
<h2 id="018Mybatis-单条插入，如何返回主键？"><a href="#018Mybatis-单条插入，如何返回主键？" class="headerlink" title="018Mybatis 单条插入，如何返回主键？"></a>018Mybatis 单条插入，如何返回主键？</h2><p>useGeneratedKeys为true,持自动生成主键,keyProperty和keyColumn分别代表数据库记录主键字段和java对象成员属性名<br>dao层 修饰符 为 void，不需要返回任何</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;insert id=&quot;insertEntity&quot; parameterType=&quot;**&quot; useGeneratedKeys=&quot;true&quot; keyProperty=&quot;id&quot; keyColumn=&quot;id&quot;&gt;</span><br></pre></td></tr></table></figure>

<h2 id="019Mybatis-批量插入，如何返回主键？"><a href="#019Mybatis-批量插入，如何返回主键？" class="headerlink" title="019Mybatis 批量插入，如何返回主键？"></a>019Mybatis 批量插入，如何返回主键？</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//dao层 修饰符 为 void，不需要返回任何</span><br><span class="line">void batchInsert(List&lt;TAlarmChannelEntity&gt; list);</span><br><span class="line">&lt;insert id=&quot;batchInsert&quot; parameterType=&quot;java.util.List&quot; useGeneratedKeys=&quot;true&quot; keyProperty=&quot;id&quot; &gt;</span><br><span class="line">    INSERT INTO  t_alarm_channel</span><br><span class="line">    (channel, silent_cycle, aggregation_mode,threshold,effective_start_time,effective_end_time,inform_obj,selected,create_time)</span><br><span class="line">    VALUES</span><br><span class="line">    &lt;foreach collection=&quot;list&quot; index=&quot;index&quot; item=&quot;bo&quot; separator=&quot;,&quot;&gt;</span><br><span class="line">       (</span><br><span class="line">          #&#123;bo.channel&#125;, #&#123;bo.silentCycle&#125;, #&#123;bo.aggregationMode&#125;,#&#123;bo.threshold&#125;,#&#123;bo.effectiveStartTime&#125;,#&#123;bo.effectiveEndTime&#125;,#&#123;bo.informObj&#125;,#&#123;bo.selected&#125;,now()</span><br><span class="line">       )</span><br><span class="line">    &lt;/foreach&gt;</span><br><span class="line">&lt;/insert&gt;</span><br></pre></td></tr></table></figure>

<h2 id="020ResultMap和ResultType的区别？"><a href="#020ResultMap和ResultType的区别？" class="headerlink" title="020ResultMap和ResultType的区别？"></a>020ResultMap和ResultType的区别？</h2><p>ResultMap是⾃⼰指定返回值与对象及与对象内部属性名和数据库列名的绑定<br>ResultType是直接返回值与别名库当中的java对象的映射</p>
<h2 id="021在mapper中如何传递多个参数"><a href="#021在mapper中如何传递多个参数" class="headerlink" title="021在mapper中如何传递多个参数?"></a>021在mapper中如何传递多个参数?</h2><p>1，第一种：<br>public UserselectUser(String name,String area); 对应的 xml,#{0}代表接收的是 dao 层中的第一个参数，#{1}代表 dao 层中第二 参数，更多参数一致往后加即可。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;select id=&quot;selectUser&quot;resultMap=&quot;BaseResultMap&quot;&gt;</span><br><span class="line">  select * from user_user_t where user_name = #&#123;0&#125; and user_area=#&#123;1&#125;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure>

<p>2，第二种：使用@param注解：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">public interface UserMapper &#123;</span><br><span class="line">    User selectUser(@param(&quot;username&quot;) String username,</span><br><span class="line">                    @param(&quot;hashedpassword&quot;) sString hashedpassword);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后,就可以在 xml 像下面这样使用(推荐封装为一个 map,作为单个参数传递给mapper):</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;select id=&quot;selectuser&quot; resulttype=&quot;user&quot;&gt;</span><br><span class="line">  select id, username, hashedpassword</span><br><span class="line">  from some_table</span><br><span class="line">  where username = #&#123;username&#125; and hashedpassword = #&#123;hashedpassword&#125;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure>

<p>3、第三种：多个参数封装成 map</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">try &#123;</span><br><span class="line">    //映射文件的命名空间.SQL 片段的 ID，就可以调用对应的映射文件中的SQL</span><br><span class="line">    //由于我们的参数超过了两个，而方法中只有一个 Object 参数收集，因此我们使用     Map 集合来装载我们的参数</span><br><span class="line">    Map &lt; String, Object &gt; map = new HashMap();</span><br><span class="line">    map.put(&quot;start&quot;, start);</span><br><span class="line">    map.put(&quot;end&quot;, end);</span><br><span class="line">    return sqlSession.selectList(&quot;StudentID.pagination&quot;, map);</span><br><span class="line">&#125; catch (Exception e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">    sqlSession.rollback();</span><br><span class="line">    throw e;</span><br><span class="line">&#125; finally &#123;</span><br><span class="line">    MybatisUtil.closeSqlSession();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="022请说说MyBatis的工作原理？"><a href="#022请说说MyBatis的工作原理？" class="headerlink" title="022请说说MyBatis的工作原理？"></a>022请说说MyBatis的工作原理？</h2><p>1.读取 MyBatis 配置文件：mybatis-config.xml 为 MyBatis 的全局配置文件，配置了 MyBatis 的运行环境等信息，例如数据库连接信息。<br>2.加载映射文件。映射文件即 SQL 映射文件，该文件中配置了操作数据库的 SQL 语句，需要在 MyBatis 配置文件 mybatis-config.xml 中加载。mybatis-config.xml 文件可以加载多个映射文件，每个文件对应数据库中的一张表。<br>3.构造会话工厂：通过 MyBatis 的环境等配置信息构建会话工厂 SqlSessionFactory。<br>4.创建会话对象：由会话工厂创建 SqlSession 对象，该对象中包含了执行 SQL 语句的所有方法。<br>5.Executor 执行器：MyBatis 底层定义了一个 Executor 接口来操作数据库，它将根据 SqlSession 传递的参数动态地生成需要执行的 SQL 语句，同时负责查询缓存的维护。<br>6.MappedStatement 对象：在 Executor 接口的执行方法中有一个 MappedStatement 类型的参数，该参数是对映射信息的封装，用于存储要映射的 SQL 语句的 id、参数等信息。<br>7.输入参数映射：输入参数类型可以是 Map、List 等集合类型，也可以是基本数据类型和 POJO 类型。输入参数映射过程类似于 JDBC 对 preparedStatement 对象设置参数的过程。<br>8.输出结果映射：输出结果类型可以是 Map、 List 等集合类型，也可以是基本数据类型和 POJO 类型。输出结果映射过程类似于 JDBC 对结果集的解析过程。</p>
<h2 id="023MyBatis中重要组件"><a href="#023MyBatis中重要组件" class="headerlink" title="023MyBatis中重要组件?"></a>023MyBatis中重要组件?</h2><p>1)Configuration：用于描述 MyBatis 主配置文件信息，MyBatis 框架在启动时会加载主配置文件，将配置信息转换为 Configuration 对象。<br>2)SqlSession：面向用户的 API，是 MyBatis 与数据库交互的接口。<br>3)Executor：SQL 执行器，用于和数据库交互。SqlSession 可以理解为 Executor 组件的外观(外观模式)，真正执行 SQL 的是 Executor 组件。<br>4)MappedStatement：用于描述 SQL 配置信息，MyBatis 框架启动时，XML 文件或者注解配置的 SQL信息会被转换为 MappedStatement 对象注册到 Configuration 组件中。<br>5)StatementHandler：封装了对 JDBC 中 Statement 对象的操作，包括为 Statement 参数占位符设置值，通过 Statement 对象执行 SQL语句。<br>6)TypeHandler：类型处理器，用于 Java 类型与 JDBC 类型之间的转换。<br>7)ParameterHandler：用于处理 SQL 中的参数占位符，为参数占位符设置值。<br>8)ResultSetHandler：封装了对 ResultSet 对象的处理逻辑，将结果集转换为 Java 实体对象。</p>
<h2 id="024Mybatis-都有哪些-Executor-执行器？它们之间的区别是什么？"><a href="#024Mybatis-都有哪些-Executor-执行器？它们之间的区别是什么？" class="headerlink" title="024Mybatis 都有哪些 Executor 执行器？它们之间的区别是什么？"></a>024Mybatis 都有哪些 Executor 执行器？它们之间的区别是什么？</h2><p>Mybatis有三种基本的Executor执行器，SimpleExecutor、ReuseExecutor、BatchExecutor。<br>1)SimpleExecutor：每执行一次update或select，就开启一个Statement对象，用完立刻关闭Statement对象。<br>2)ReuseExecutor：执行update或select，以sql作为key查找Statement对象，存在就使用，不存在就创建，用完后，不关闭Statement对象，而是放置于Map&lt;String, Statement&gt;内，供下一次使用。简言之，就是重复使用Statement对象。<br>3)BatchExecutor：执行update（没有select，JDBC批处理不支持select），将所有sql都添加到批处理中（addBatch()），等待统一执行（executeBatch()），它缓存了多个Statement对象，每个Statement对象都是addBatch()完毕后，等待逐一执行executeBatch()批处理。与JDBC批处理相同。<br>作用范围：Executor的这些特点，都严格限制在SqlSession生命周期范围内。</p>
<h2 id="025Spring和Mybatis整合之后为什么⼀级缓存会失效？"><a href="#025Spring和Mybatis整合之后为什么⼀级缓存会失效？" class="headerlink" title="025Spring和Mybatis整合之后为什么⼀级缓存会失效？"></a>025Spring和Mybatis整合之后为什么⼀级缓存会失效？</h2><p>⼀级缓存使⽤者可以随时使⽤或者销毁缓存，从SqlSession对象打开时缓存就已经存在。当关闭SqlSession对象缓存就失效。当与spring整合的时候，直接跳过SqlSession对象，⽆法直接操作到SqlSession对象，spring在操作SqlSession的时候，不知道⽤户什么时候关闭，所以每调⽤完⼀个dao⽅法就关闭了，所以导致⼀级缓存失效。<br>如果开启了事务，⼀级缓存就会⽣效，因为开启了事务，执⾏完dao就不会销毁，因为⼀旦销毁，事务就没有了，你开启了事务，Spring就知道你什么时候需要结束</p>

                <hr>
                

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2024/03/22/MySQL/" data-toggle="tooltip" data-placement="top"
                           title="MySQL">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2024/03/22/Linux/" data-toggle="tooltip" data-placement="top"
                           title="Linux">Next Post &rarr;</a>
                    </li>
                    
                </ul>

                

                


                <!--加入新的评论系统-->
                

                

            </div>

            <div class="hidden-xs col-sm-3 toc-col">
                <div class="toc-wrap">
                    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Mybaits%E9%9D%A2%E8%AF%95%E9%A2%98"><span class="toc-text">Mybaits面试题</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#001%E7%AE%80%E5%8D%95%E4%BB%8B%E7%BB%8D%E4%B8%8BMybatis%EF%BC%9F"><span class="toc-text">001简单介绍下Mybatis？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#002Mybatis%E7%BC%96%E7%A8%8B%E6%AD%A5%E9%AA%A4-%EF%BC%9F"><span class="toc-text">002Mybatis编程步骤 ？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#003MyBatis%E7%9A%84%E4%BC%98%E7%82%B9%EF%BC%9F"><span class="toc-text">003MyBatis的优点？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#004MyBatis%E7%9A%84%E7%BC%BA%E7%82%B9%EF%BC%9F"><span class="toc-text">004MyBatis的缺点？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#005MyBatis%E4%B8%AD-%E5%92%8C-%E7%9A%84%E5%8C%BA%E5%88%AB%EF%BC%9F"><span class="toc-text">005MyBatis中$和#的区别？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#006Mybatis%E7%9A%84%E4%B8%80%E7%BA%A7%E3%80%81%E4%BA%8C%E7%BA%A7%E7%BC%93%E5%AD%98%EF%BC%9F"><span class="toc-text">006Mybatis的一级、二级缓存？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#007Mybatis-%E6%98%AF%E5%A6%82%E4%BD%95%E8%BF%9B%E8%A1%8C%E5%88%86%E9%A1%B5%E7%9A%84%EF%BC%9F%E5%88%86%E9%A1%B5%E6%8F%92%E4%BB%B6%E7%9A%84%E5%8E%9F%E7%90%86%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-text">007Mybatis 是如何进行分页的？分页插件的原理是什么？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#008Mapper%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86%E7%9A%84%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86%EF%BC%9F"><span class="toc-text">008Mapper动态代理的实现原理？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#009MyBatis%E6%98%AF%E5%90%A6%E6%94%AF%E6%8C%81%E5%BB%B6%E8%BF%9F%E5%8A%A0%E8%BD%BD%EF%BC%9F%E5%A6%82%E6%9E%9C%E6%94%AF%E6%8C%81%EF%BC%8C%E5%AE%83%E7%9A%84%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-text">009MyBatis是否支持延迟加载？如果支持，它的实现原理是什么？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#010MyBatis%E4%B8%8EHibernate%E6%9C%89%E5%93%AA%E4%BA%9B%E4%B8%8D%E5%90%8C%EF%BC%9F"><span class="toc-text">010MyBatis与Hibernate有哪些不同？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#011IBatis-%E5%92%8C-MyBatis-%E5%9C%A8%E7%BB%86%E8%8A%82%E4%B8%8A%E6%9C%89%E5%93%AA%E4%BA%9B%E4%B8%8D%E5%90%8C%EF%BC%9F"><span class="toc-text">011IBatis 和 MyBatis 在细节上有哪些不同？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#012%E4%BD%BF%E7%94%A8-MyBatis-%E7%9A%84-mapper-%E6%8E%A5%E5%8F%A3%E8%B0%83%E7%94%A8%E6%97%B6%E6%9C%89%E5%93%AA%E4%BA%9B%E8%A6%81%E6%B1%82%EF%BC%9F"><span class="toc-text">012使用 MyBatis 的 mapper 接口调用时有哪些要求？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#013%E5%BD%93%E5%AE%9E%E4%BD%93%E7%B1%BB%E4%B8%AD%E7%9A%84%E5%B1%9E%E6%80%A7%E5%90%8D%E5%92%8C%E8%A1%A8%E4%B8%AD%E7%9A%84%E5%AD%97%E6%AE%B5%E5%90%8D%E4%B8%8D%E4%B8%80%E6%A0%B7-%EF%BC%8C%E6%80%8E%E4%B9%88%E5%8A%9E-%EF%BC%9F"><span class="toc-text">013当实体类中的属性名和表中的字段名不一样 ，怎么办 ？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#014%E6%A8%A1%E7%B3%8A%E6%9F%A5%E8%AF%A2-like-%E8%AF%AD%E5%8F%A5%E8%AF%A5%E6%80%8E%E4%B9%88%E5%86%99"><span class="toc-text">014模糊查询 like 语句该怎么写?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#015MyBatis%E5%8A%A8%E6%80%81sql%E6%98%AF%E5%81%9A%E4%BB%80%E4%B9%88%E7%9A%84%EF%BC%9F%E9%83%BD%E6%9C%89%E5%93%AA%E4%BA%9B%E5%8A%A8%E6%80%81sql%EF%BC%9F%E8%83%BD%E7%AE%80%E8%BF%B0%E4%B8%80%E4%B8%8B%E5%8A%A8%E6%80%81sql%E7%9A%84%E6%89%A7%E8%A1%8C%E5%8E%9F%E7%90%86%E4%B8%8D%EF%BC%9F"><span class="toc-text">015MyBatis动态sql是做什么的？都有哪些动态sql？能简述一下动态sql的执行原理不？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#016%E8%BF%99%E4%B8%AADao%E6%8E%A5%E5%8F%A3%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9FDao%E6%8E%A5%E5%8F%A3%E9%87%8C%E7%9A%84%E6%96%B9%E6%B3%95%EF%BC%8C%E5%8F%82%E6%95%B0%E4%B8%8D%E5%90%8C%E6%97%B6%EF%BC%8C%E6%96%B9%E6%B3%95%E8%83%BD%E9%87%8D%E8%BD%BD%E5%90%97"><span class="toc-text">016这个Dao接口的工作原理是什么？Dao接口里的方法，参数不同时，方法能重载吗?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#017%E4%B8%80%E5%AF%B9%E4%B8%80%E3%80%81%E4%B8%80%E5%AF%B9%E5%A4%9A%E7%9A%84%E5%85%B3%E8%81%94%E6%9F%A5%E8%AF%A2-%EF%BC%9F"><span class="toc-text">017一对一、一对多的关联查询 ？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#018Mybatis-%E5%8D%95%E6%9D%A1%E6%8F%92%E5%85%A5%EF%BC%8C%E5%A6%82%E4%BD%95%E8%BF%94%E5%9B%9E%E4%B8%BB%E9%94%AE%EF%BC%9F"><span class="toc-text">018Mybatis 单条插入，如何返回主键？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#019Mybatis-%E6%89%B9%E9%87%8F%E6%8F%92%E5%85%A5%EF%BC%8C%E5%A6%82%E4%BD%95%E8%BF%94%E5%9B%9E%E4%B8%BB%E9%94%AE%EF%BC%9F"><span class="toc-text">019Mybatis 批量插入，如何返回主键？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#020ResultMap%E5%92%8CResultType%E7%9A%84%E5%8C%BA%E5%88%AB%EF%BC%9F"><span class="toc-text">020ResultMap和ResultType的区别？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#021%E5%9C%A8mapper%E4%B8%AD%E5%A6%82%E4%BD%95%E4%BC%A0%E9%80%92%E5%A4%9A%E4%B8%AA%E5%8F%82%E6%95%B0"><span class="toc-text">021在mapper中如何传递多个参数?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#022%E8%AF%B7%E8%AF%B4%E8%AF%B4MyBatis%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86%EF%BC%9F"><span class="toc-text">022请说说MyBatis的工作原理？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#023MyBatis%E4%B8%AD%E9%87%8D%E8%A6%81%E7%BB%84%E4%BB%B6"><span class="toc-text">023MyBatis中重要组件?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#024Mybatis-%E9%83%BD%E6%9C%89%E5%93%AA%E4%BA%9B-Executor-%E6%89%A7%E8%A1%8C%E5%99%A8%EF%BC%9F%E5%AE%83%E4%BB%AC%E4%B9%8B%E9%97%B4%E7%9A%84%E5%8C%BA%E5%88%AB%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-text">024Mybatis 都有哪些 Executor 执行器？它们之间的区别是什么？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#025Spring%E5%92%8CMybatis%E6%95%B4%E5%90%88%E4%B9%8B%E5%90%8E%E4%B8%BA%E4%BB%80%E4%B9%88%E2%BC%80%E7%BA%A7%E7%BC%93%E5%AD%98%E4%BC%9A%E5%A4%B1%E6%95%88%EF%BC%9F"><span class="toc-text">025Spring和Mybatis整合之后为什么⼀级缓存会失效？</span></a></li></ol></li></ol>
                </div>
            </div>
        </div>

        <div class="row">
            <!-- Sidebar Container -->

            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                
                <section>
                    <!-- no hr -->
                    <h5 class="text-center">
                        <a href="/tags/">FEATURED TAGS</a>
                    </h5>
                    <div class="tags">
                        
                    </div>
                </section>
                

                <!-- Friends Blog -->
                
            </div>
        </div>

    </div>
</article>







<!-- Footer -->
<!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 text-center">
                <br>
                <ul class="list-inline text-center">
                
                
                    <li>
                        <a target="_blank" href="https://twitter.com/ehazon">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                
                
                    <li>
                        <a target="_blank" href="https://www.zhihu.com/people/megahertz">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa  fa-stack-1x fa-inverse">知</i>
                            </span>
                        </a>
                    </li>
                

                
                    <li>
                        <a target="_blank" href="http://weibo.com/haojen">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-weibo fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                

                
                    <li>
                        <a target="_blank"  href="https://github.com/haojen">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                

                </ul>
                <p class="copyright text-muted">
                    Copyright &copy; Haojen 2024
                    <br>
                    <span id="busuanzi_container_site_pv" style="font-size: 12px;">PV: <span id="busuanzi_value_site_pv"></span> Times</span>
                    <br>
                    Theme by <a href="https://haojen.github.io/">Haojen Ma</a>
                </p>

            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->

<script src="/js/jquery.min.js"></script>


<!-- Bootstrap Core JavaScript -->

<script src="/js/bootstrap.min.js"></script>


<!-- Custom Theme JavaScript -->

<script src="/js/blog.js"></script>


<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async("http://haojen.github.io/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("//cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>



<!-- Google Analytics -->



<!-- Baidu Tongji -->


<!-- swiftype -->
<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install','','2.0.0');
</script>

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<!--wechat title img-->
<img class="wechat-title-img" src="">
</body>

</html>
